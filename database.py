import sys

import requests
import json
import argparse
from dotenv import load_dotenv
import os
import csv
from datetime import datetime, date, timedelta
import mysql.connector

def connection_db():
    load_dotenv()
    
    MYSQL_HOST = os.getenv("MYSQL_HOST")
    MYSQL_USER = os.getenv("MYSQL_USER")
    MYSQL_PASSWORD = os.getenv("MYSQL_PASSWORD")
    MYSQL_DB = os.getenv("MYSQL_DB")
    
    conn = mysql.connector.connect(
        host=MYSQL_HOST,
        user=MYSQL_USER,
        password=MYSQL_PASSWORD,
        database=MYSQL_DB
    )
    return conn

def insert_data(name, date, severity, description, score, more):
    conn = connection_db()

    cursor = conn.cursor()

    query = "INSERT INTO cve (name, date, severity, description, score, more) VALUES (%s, %s, %s, %s, %s, %s)"

    cursor.execute(query, (name, date, severity, description, score, more))
        
    conn.commit()

    cursor.close()
    conn.close()
    
def list_bdd():
    conn = connection_db()

    mycursor = conn.cursor()

    mycursor.execute("SELECT * FROM cve")

    result = mycursor.fetchall()
    columns = [col[0] for col in mycursor.description]

    print('\t'.join(columns))
    for row in result:
        print('\t'.join(str(x) for x in row))